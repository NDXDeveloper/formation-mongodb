ğŸ” Retour au [Sommaire](/SOMMAIRE.md)

# 14.6 Monitoring et Alertes dans Atlas

## Introduction

Le monitoring et l'alerting sont **essentiels** pour maintenir des bases de donnÃ©es performantes et fiables en production. Atlas fournit un Ã©cosystÃ¨me complet d'observabilitÃ© : mÃ©triques en temps rÃ©el, dashboards prÃ©configurÃ©s, Performance Advisor, Query Profiler, et un systÃ¨me d'alerting configurable. Cette section guide les Ã©quipes DevOps et SRE dans la mise en place d'une stratÃ©gie de monitoring production-ready.

### ğŸ¯ Objectifs de cette Section

- Comprendre les mÃ©triques clÃ©s Ã  surveiller
- Utiliser les dashboards Atlas natifs
- Configurer le Performance Advisor et Query Profiler
- CrÃ©er des alertes intelligentes et actionables
- IntÃ©grer avec des outils externes (Datadog, Prometheus, PagerDuty)
- ImplÃ©menter une stratÃ©gie d'observabilitÃ© complÃ¨te

---

## ğŸ“Š Architecture de Monitoring Atlas

### Vue d'Ensemble

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ATLAS MONITORING ARCHITECTURE                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚   COLLECTION LAYER                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚                                                                  â”‚â”‚
â”‚   â”‚  MongoDB Cluster                                                 â”‚â”‚
â”‚   â”‚  â”œâ”€ System Metrics (CPU, RAM, Disk, Network)                     â”‚â”‚
â”‚   â”‚  â”œâ”€ Database Metrics (Operations, Connections, Queries)          â”‚â”‚
â”‚   â”‚  â”œâ”€ Profiler Data (Slow queries, execution plans)                â”‚â”‚
â”‚   â”‚  â””â”€ Logs (mongod.log, audit logs)                                â”‚â”‚
â”‚   â”‚                                                                  â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                            â–¼                                          â”‚
â”‚   AGGREGATION & PROCESSING                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚                                                                  â”‚â”‚
â”‚   â”‚  Atlas Monitoring Service                                        â”‚â”‚
â”‚   â”‚  â”œâ”€ Metrics aggregation (1-min granularity)                      â”‚â”‚
â”‚   â”‚  â”œâ”€ Performance analysis                                         â”‚â”‚
â”‚   â”‚  â”œâ”€ Alert evaluation                                             â”‚â”‚
â”‚   â”‚  â””â”€ Historical data retention                                    â”‚â”‚
â”‚   â”‚                                                                  â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                            â–¼                                          â”‚
â”‚   VISUALIZATION & ALERTING                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚                                                                  â”‚â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚â”‚
â”‚   â”‚  â”‚ Dashboards   â”‚  â”‚  Performance â”‚  â”‚   Alerting   â”‚            â”‚â”‚
â”‚   â”‚  â”‚ (Real-time)  â”‚  â”‚   Advisor    â”‚  â”‚   Engine     â”‚            â”‚â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚â”‚
â”‚   â”‚                                              â”‚                   â”‚â”‚
â”‚   â”‚                                              â–¼                   â”‚â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚â”‚
â”‚   â”‚  â”‚ Notification Channels                                â”‚        â”‚â”‚
â”‚   â”‚  â”‚ â€¢ Email                                              â”‚        â”‚â”‚
â”‚   â”‚  â”‚ â€¢ Slack                                              â”‚        â”‚â”‚
â”‚   â”‚  â”‚ â€¢ PagerDuty                                          â”‚        â”‚â”‚
â”‚   â”‚  â”‚ â€¢ Webhooks                                           â”‚        â”‚â”‚
â”‚   â”‚  â”‚ â€¢ OpsGenie                                           â”‚        â”‚â”‚
â”‚   â”‚  â”‚ â€¢ VictorOps                                          â”‚        â”‚â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚â”‚
â”‚   â”‚                                                                  â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                            â–¼                                          â”‚
â”‚   INTEGRATIONS                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚  â€¢ Datadog                                                       â”‚â”‚
â”‚   â”‚  â€¢ New Relic                                                     â”‚â”‚
â”‚   â”‚  â€¢ Prometheus (via MongoDB Exporter)                             â”‚â”‚
â”‚   â”‚  â€¢ Grafana                                                       â”‚â”‚
â”‚   â”‚  â€¢ Third-party monitoring tools                                  â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ MÃ©triques ClÃ©s Ã  Surveiller

### CatÃ©gories de MÃ©triques

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CRITICAL METRICS MATRIX                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  CATEGORY          METRIC               THRESHOLD      SEVERITY        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  RESOURCE          CPU Usage            > 80%          âš ï¸ Warning      â”‚
â”‚  UTILIZATION       Memory Usage         > 85%          ğŸ”¥ Critical     â”‚
â”‚                    Disk I/O Wait        > 50%          âš ï¸ Warning      â”‚
â”‚                    Network Bandwidth    > 80%          âš ï¸ Warning      â”‚
â”‚                                                                        â”‚
â”‚  DATABASE          Operations/sec       Baseline Â±50%  â„¹ï¸ Info         â”‚
â”‚  OPERATIONS        Connections          > 80% max      âš ï¸ Warning      â”‚
â”‚                    Replication Lag      > 10s          ğŸ”¥ Critical     â”‚
â”‚                    Oplog Window         < 1 hour       âš ï¸ Warning      â”‚
â”‚                                                                        â”‚
â”‚  PERFORMANCE       Query Execution      > 1000ms       âš ï¸ Warning      â”‚
â”‚                    Index Miss Ratio     > 20%          âš ï¸ Warning      â”‚
â”‚                    Cache Hit Ratio      < 80%          âš ï¸ Warning      â”‚
â”‚                    Slow Queries         > 100/hour     â„¹ï¸ Info         â”‚
â”‚                                                                        â”‚
â”‚  AVAILABILITY      Primary Reachable    = No           ğŸ”¥ Critical     â”‚
â”‚                    Replica Set Health   < 3 healthy    ğŸ”¥ Critical     â”‚
â”‚                    Failed Elections     > 0            âš ï¸ Warning      â”‚
â”‚                                                                        â”‚
â”‚  STORAGE           Disk Usage           > 80%          âš ï¸ Warning      â”‚
â”‚                    Index Size           > RAM          â„¹ï¸ Info         â”‚
â”‚                    Data Size Growth     > 20%/day      â„¹ï¸ Info         â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### MÃ©triques SystÃ¨me (Hardware)

```yaml
# Infrastructure Metrics
system_metrics:
  cpu:
    - metric: "normalized_cpu_user"
      description: "User CPU utilization (normalized across cores)"
      unit: "percentage"
      critical_threshold: 85
      warning_threshold: 70

    - metric: "normalized_cpu_steal"
      description: "CPU steal time (cloud contention)"
      unit: "percentage"
      warning_threshold: 10

  memory:
    - metric: "memory_utilization"
      description: "RAM usage percentage"
      unit: "percentage"
      critical_threshold: 90
      warning_threshold: 80

    - metric: "swap_usage"
      description: "Swap space utilization"
      unit: "bytes"
      warning_threshold: 1GB  # Any swap usage is concerning

  disk:
    - metric: "disk_partition_utilization"
      description: "Disk space used"
      unit: "percentage"
      critical_threshold: 90
      warning_threshold: 80

    - metric: "disk_partition_iops_total"
      description: "Total IOPS (read + write)"
      unit: "operations/sec"
      info_threshold: "80% of provisioned IOPS"

    - metric: "disk_partition_latency_write"
      description: "Write latency"
      unit: "milliseconds"
      warning_threshold: 20

  network:
    - metric: "network_bytes_in"
      description: "Inbound network traffic"
      unit: "bytes/sec"
      info_threshold: "baseline +50%"

    - metric: "network_bytes_out"
      description: "Outbound network traffic"
      unit: "bytes/sec"
      info_threshold: "baseline +50%"
```

### MÃ©triques MongoDB (Database)

```yaml
# Database Operations Metrics
database_metrics:
  operations:
    - metric: "opcounters_query"
      description: "Query operations per second"
      unit: "ops/sec"

    - metric: "opcounters_insert"
      description: "Insert operations per second"
      unit: "ops/sec"

    - metric: "opcounters_update"
      description: "Update operations per second"
      unit: "ops/sec"

    - metric: "opcounters_delete"
      description: "Delete operations per second"
      unit: "ops/sec"

    - metric: "opcounters_command"
      description: "Command operations per second"
      unit: "ops/sec"

  connections:
    - metric: "connections_current"
      description: "Current open connections"
      unit: "count"
      warning_threshold: "80% of max connections"

    - metric: "connections_available"
      description: "Available connections"
      unit: "count"
      critical_threshold: 100

  replication:
    - metric: "replication_lag"
      description: "Replication lag from primary"
      unit: "seconds"
      critical_threshold: 10
      warning_threshold: 5

    - metric: "oplog_master_time"
      description: "Oplog window (time coverage)"
      unit: "seconds"
      warning_threshold: 3600  # < 1 hour

  query_performance:
    - metric: "query_executor_scanned_objects"
      description: "Documents examined per query"
      unit: "count"
      info_threshold: "> 1000/query (avg)"

    - metric: "query_executor_scanned_keys"
      description: "Index entries examined"
      unit: "count"

    - metric: "query_targeting_scanned_objects_per_returned"
      description: "Scan ratio (examined/returned)"
      unit: "ratio"
      warning_threshold: 10  # Examining 10x more than returning
```

---

## ğŸ“Š Dashboards Atlas

### Dashboards PrÃ©configurÃ©s

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ATLAS NATIVE DASHBOARDS                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  1. REAL-TIME PERFORMANCE                                             â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ â€¢ Operations per second (reads/writes)                         â”‚â”‚
â”‚     â”‚ â€¢ Active connections                                           â”‚â”‚
â”‚     â”‚ â€¢ Query execution time (avg, p99)                              â”‚â”‚
â”‚     â”‚ â€¢ Network traffic in/out                                       â”‚â”‚
â”‚     â”‚ â€¢ Update: Every 10 seconds                                     â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                       â”‚
â”‚  2. HARDWARE METRICS                                                  â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ â€¢ CPU utilization (user, system, iowait)                       â”‚â”‚
â”‚     â”‚ â€¢ Memory utilization                                           â”‚â”‚
â”‚     â”‚ â€¢ Disk IOPS and latency                                        â”‚â”‚
â”‚     â”‚ â€¢ Network bandwidth                                            â”‚â”‚
â”‚     â”‚ â€¢ Update: Every 1 minute                                       â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                       â”‚
â”‚  3. OPCOUNTERS                                                        â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ â€¢ Query, Insert, Update, Delete, Command counts                â”‚â”‚
â”‚     â”‚ â€¢ Breakdown by operation type                                  â”‚â”‚
â”‚     â”‚ â€¢ Trend analysis over time                                     â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                       â”‚
â”‚  4. REPLICA SET STATUS                                                â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ â€¢ Primary/Secondary status                                     â”‚â”‚
â”‚     â”‚ â€¢ Replication lag per secondary                                â”‚â”‚
â”‚     â”‚ â€¢ Oplog window                                                 â”‚â”‚
â”‚     â”‚ â€¢ Election events                                              â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                       â”‚
â”‚  5. QUERY PERFORMANCE                                                 â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ â€¢ Slow queries (> 100ms)                                       â”‚â”‚
â”‚     â”‚ â€¢ Query execution time distribution                            â”‚â”‚
â”‚     â”‚ â€¢ Index usage statistics                                       â”‚â”‚
â”‚     â”‚ â€¢ Scanned vs returned documents                                â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                       â”‚
â”‚  6. CONNECTIONS                                                       â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ â€¢ Current connections                                          â”‚â”‚
â”‚     â”‚ â€¢ Available connections                                        â”‚â”‚
â”‚     â”‚ â€¢ Connection creation rate                                     â”‚â”‚
â”‚     â”‚ â€¢ Read/Write distribution                                      â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Analyse d'un Dashboard

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   EXAMPLE: HARDWARE METRICS DASHBOARD                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  CPU UTILIZATION                                     [Last 1 hour]    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 100% â”¤                                                           â”‚ â”‚
â”‚  â”‚  90% â”¤                              â•­â”€â•®                          â”‚ â”‚
â”‚  â”‚  80% â”¤                         â•­â”€â”€â”€â”€â•¯ â•°â•®                         â”‚ â”‚
â”‚  â”‚  70% â”¤                    â•­â”€â”€â”€â”€â•¯       â•°â”€â•®                       â”‚ â”‚
â”‚  â”‚  60% â”¤               â•­â”€â”€â”€â”€â•¯              â•°â”€â”€â”€â•®                   â”‚ â”‚
â”‚  â”‚  50% â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯                       â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚
â”‚  â”‚   0% â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚
â”‚  â”‚      10:00    10:15    10:30    10:45    11:00                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  ğŸ”´ Alert triggered at 10:42 (CPU > 85%)                              â”‚
â”‚                                                                       â”‚
â”‚  MEMORY UTILIZATION                                  [Last 1 hour]    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 100% â”¤                                                           â”‚ â”‚
â”‚  â”‚  80% â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚
â”‚  â”‚  60% â”¤                                                           â”‚ â”‚
â”‚  â”‚  40% â”¤                                                           â”‚ â”‚
â”‚  â”‚  20% â”¤                                                           â”‚ â”‚
â”‚  â”‚   0% â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  âœ… Stable at 78% (within normal range)                               â”‚
â”‚                                                                       â”‚
â”‚  DISK IOPS                                           [Last 1 hour]    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 6000 â”¤                                          â•­â•®               â”‚ â”‚
â”‚  â”‚ 5000 â”¤                                     â•­â”€â”€â”€â”€â•¯â•°â•®              â”‚ â”‚
â”‚  â”‚ 4000 â”¤                                â•­â”€â”€â”€â”€â•¯      â•°â•®             â”‚ â”‚
â”‚  â”‚ 3000 â”¤                           â•­â”€â”€â”€â”€â•¯            â•°â”€â•®           â”‚ â”‚
â”‚  â”‚ 2000 â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯                  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚ â”‚
â”‚  â”‚    0 â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  Read: 3,200 IOPS | Write: 1,800 IOPS | Limit: 6,000 IOPS             â”‚
â”‚                                                                       â”‚
â”‚  INTERPRETATION:                                                      â”‚
â”‚  â€¢ CPU spike at 10:42 correlates with IOPS spike                      â”‚
â”‚  â€¢ Likely caused by batch job or analytics query                      â”‚
â”‚  â€¢ Memory stable â†’ Not a memory pressure issue                        â”‚
â”‚  â€¢ Action: Check slow query log for 10:40-10:45 timeframe             â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Performance Advisor

Le **Performance Advisor** analyse automatiquement vos workloads et recommande des optimisations.

### Architecture Performance Advisor

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PERFORMANCE ADVISOR WORKFLOW                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  1. DATA COLLECTION                                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ â€¢ Query profiler data (slow queries)                           â”‚â”‚
â”‚     â”‚ â€¢ Index usage statistics                                       â”‚â”‚
â”‚     â”‚ â€¢ Query execution plans (explain output)                       â”‚â”‚
â”‚     â”‚ â€¢ Collection scan patterns                                     â”‚â”‚
â”‚     â”‚ â€¢ Update: Continuous                                           â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â–¼                                        â”‚
â”‚  2. ANALYSIS ENGINE                                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ Machine Learning algorithms analyze:                           â”‚â”‚
â”‚     â”‚ â€¢ Query patterns                                               â”‚â”‚
â”‚     â”‚ â€¢ Index effectiveness                                          â”‚â”‚
â”‚     â”‚ â€¢ Schema design impact                                         â”‚â”‚
â”‚     â”‚ â€¢ Read/Write ratios                                            â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â–¼                                        â”‚
â”‚  3. RECOMMENDATIONS                                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ Types:                                                         â”‚â”‚
â”‚     â”‚ âœ… Create Index (for frequently queried fields)                â”‚â”‚
â”‚     â”‚ âš ï¸ Drop Unused Index (freeing resources)                       â”‚â”‚
â”‚     â”‚ ğŸ”„ Modify Index (change order, add/remove fields)              â”‚â”‚
â”‚     â”‚ ğŸ“Š Schema Design (restructure for performance)                 â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â–¼                                        â”‚
â”‚  4. IMPACT ANALYSIS                                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ For each recommendation:                                       â”‚â”‚
â”‚     â”‚ â€¢ Estimated query improvement                                  â”‚â”‚
â”‚     â”‚ â€¢ Index size impact                                            â”‚â”‚
â”‚     â”‚ â€¢ Write performance impact                                     â”‚â”‚
â”‚     â”‚ â€¢ Memory usage change                                          â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Exemple de Recommandations

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PERFORMANCE ADVISOR RECOMMENDATIONS                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  RECOMMENDATION #1 - CREATE INDEX                    Impact: ğŸ”¥ High  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Collection: users                                                â”‚ â”‚
â”‚  â”‚ Namespace: mydb.users                                            â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ Suggested Index:                                                 â”‚ â”‚
â”‚  â”‚   { email: 1, status: 1 }                                        â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ Reason:                                                          â”‚ â”‚
â”‚  â”‚ â€¢ 1,247 queries affected per hour                                â”‚ â”‚
â”‚  â”‚ â€¢ Average execution time: 1,856ms â†’ Expected: 12ms               â”‚ â”‚
â”‚  â”‚ â€¢ Current: Collection scan (COLLSCAN)                            â”‚ â”‚
â”‚  â”‚ â€¢ Expected: Index scan (IXSCAN)                                  â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ Example Query:                                                   â”‚ â”‚
â”‚  â”‚   db.users.find({ email: "user@example.com", status: "active" }) â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ Impact:                                                          â”‚ â”‚
â”‚  â”‚ â€¢ Query improvement: 99.4% faster                                â”‚ â”‚
â”‚  â”‚ â€¢ Index size: ~25 MB                                             â”‚ â”‚
â”‚  â”‚ â€¢ Write performance: -2% (acceptable)                            â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ [Create Index] [Dismiss] [View Queries]                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                       â”‚
â”‚  RECOMMENDATION #2 - DROP UNUSED INDEX               Impact: âš ï¸ Mediumâ”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Collection: orders                                               â”‚ â”‚
â”‚  â”‚ Namespace: mydb.orders                                           â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ Unused Index:                                                    â”‚ â”‚
â”‚  â”‚   { createdAt: 1, customerId: 1 }                                â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ Reason:                                                          â”‚ â”‚
â”‚  â”‚ â€¢ Not used in last 30 days                                       â”‚ â”‚
â”‚  â”‚ â€¢ Consuming 180 MB of RAM                                        â”‚ â”‚
â”‚  â”‚ â€¢ Slowing down writes by ~3%                                     â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ Impact of Dropping:                                              â”‚ â”‚
â”‚  â”‚ â€¢ Free 180 MB RAM                                                â”‚ â”‚
â”‚  â”‚ â€¢ Improve write performance: +3%                                 â”‚ â”‚
â”‚  â”‚ â€¢ Reduce index maintenance overhead                              â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ [Drop Index] [Keep Monitoring] [Dismiss]                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Configuration Performance Advisor

```javascript
// Performance Advisor est activÃ© par dÃ©faut, mais configurable

// Via Atlas API - Get recommendations
const recommendations = await fetch(
  `https://cloud.mongodb.com/api/atlas/v1.0/groups/${projectId}/processes/${hostname}/performanceAdvisor/suggestions`,
  {
    headers: {
      'Authorization': `Bearer ${apiToken}`
    }
  }
).then(r => r.json());

recommendations.suggestions.forEach(suggestion => {
  console.log(`Type: ${suggestion.type}`);
  console.log(`Impact: ${suggestion.impact}`);
  console.log(`Index: ${JSON.stringify(suggestion.index)}`);
  console.log(`Estimated improvement: ${suggestion.estimatedImprovement}`);
});

// Terraform: Enable/Configure Performance Advisor settings
// (Settings are at project level)
resource "mongodbatlas_project" "main" {
  name   = "production"
  org_id = var.org_id

  # Performance Advisor runs automatically
  # No explicit configuration needed
}
```

---

## ğŸ¢ Query Profiler

Le **Query Profiler** enregistre les requÃªtes lentes et fournit des dÃ©tails d'exÃ©cution.

### Configuration du Profiler

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       QUERY PROFILER LEVELS                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  LEVEL 0 - OFF                                                         â”‚
â”‚  â€¢ No profiling                                                        â”‚
â”‚  â€¢ Lowest overhead                                                     â”‚
â”‚  â€¢ Use: Never (always keep at least Level 1)                           â”‚
â”‚                                                                        â”‚
â”‚  LEVEL 1 - SLOW QUERIES (Default)                      âœ… Recommended  â”‚
â”‚  â€¢ Profile queries slower than threshold (default: 100ms)              â”‚
â”‚  â€¢ Moderate overhead (~2-5%)                                           â”‚
â”‚  â€¢ Use: Production environments                                        â”‚
â”‚                                                                        â”‚
â”‚  LEVEL 2 - ALL QUERIES                                                 â”‚
â”‚  â€¢ Profile ALL operations                                              â”‚
â”‚  â€¢ High overhead (10-20%)                                              â”‚
â”‚  â€¢ Use: Development, debugging only                                    â”‚
â”‚                                                                        â”‚
â”‚  ATLAS DEFAULT: Level 1, Threshold 100ms                               â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Configuration via Atlas UI

```yaml
# Atlas UI Configuration
profiler_settings:
  enabled: true
  mode: "SLOW_ONLY"  # or "ALL"
  slow_operation_threshold_ms: 100

  # Advanced options
  sample_rate: 1.0  # 1.0 = 100%, 0.1 = 10%
  max_profile_size_mb: 200
```

### Analyse des Slow Queries

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       QUERY PROFILER OUTPUT                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  SLOW QUERY #1                                       Duration: 1,856msâ”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Operation: find                                                  â”‚ â”‚
â”‚  â”‚ Namespace: mydb.users                                            â”‚ â”‚
â”‚  â”‚ Timestamp: 2025-12-08 10:42:15                                   â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ Query:                                                           â”‚ â”‚
â”‚  â”‚   { email: "user@example.com", status: "active" }                â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ Execution Plan:                                                  â”‚ â”‚
â”‚  â”‚   Stage: COLLSCAN                              âš ï¸ Full scan!     â”‚ â”‚
â”‚  â”‚   Documents Examined: 1,250,000                                  â”‚ â”‚
â”‚  â”‚   Documents Returned: 1                                          â”‚ â”‚
â”‚  â”‚   Scan Ratio: 1,250,000:1                     ğŸ”¥ Extremely poor  â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ Recommendation:                                                  â”‚ â”‚
â”‚  â”‚   Create index: { email: 1, status: 1 }                          â”‚ â”‚
â”‚  â”‚   Expected improvement: 99.4% faster                             â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ [Create Index] [Explain Plan] [Show Query Shape]                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                       â”‚
â”‚  SLOW QUERY #2                                       Duration: 487ms  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Operation: aggregate                                             â”‚ â”‚
â”‚  â”‚ Namespace: mydb.orders                                           â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ Pipeline:                                                        â”‚ â”‚
â”‚  â”‚   [                                                              â”‚ â”‚
â”‚  â”‚     { $match: { createdAt: { $gte: ISODate("2025-01-01") } } },  â”‚ â”‚
â”‚  â”‚     { $group: { _id: "$customerId", total: { $sum: "$amount" } } } â”‚
â”‚  â”‚   ]                                                              â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ Execution Stats:                                                 â”‚ â”‚
â”‚  â”‚   Stage: IXSCAN â†’ GROUP                        âœ… Using index    â”‚ â”‚
â”‚  â”‚   Documents Examined: 45,000                                     â”‚ â”‚
â”‚  â”‚   Documents Returned: 1,200                                      â”‚ â”‚
â”‚  â”‚   Scan Ratio: 37.5:1                          âš ï¸ Could improve   â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚ Recommendation:                                                  â”‚ â”‚
â”‚  â”‚   Consider compound index: { createdAt: 1, customerId: 1 }       â”‚ â”‚
â”‚  â”‚   Expected improvement: ~30% faster                              â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš¨ SystÃ¨me d'Alerting

### Architecture Alerting

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ALERTING WORKFLOW                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  1. METRIC COLLECTION                                                 â”‚
â”‚     Every 1 minute, Atlas collects all metrics                        â”‚
â”‚                              â–¼                                        â”‚
â”‚  2. ALERT EVALUATION                                                  â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ For each alert rule:                                           â”‚â”‚
â”‚     â”‚ â€¢ Compare metric to threshold                                  â”‚â”‚
â”‚     â”‚ â€¢ Check condition (>, <, =, etc.)                              â”‚â”‚
â”‚     â”‚ â€¢ Evaluate for duration window                                 â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â–¼                                        â”‚
â”‚  3. ALERT TRIGGERING                                                  â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ If condition met:                                              â”‚â”‚
â”‚     â”‚ â€¢ Alert state: OK â†’ ALERT                                      â”‚â”‚
â”‚     â”‚ â€¢ Start escalation timer                                       â”‚â”‚
â”‚     â”‚ â€¢ Generate alert details                                       â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â–¼                                        â”‚
â”‚  4. NOTIFICATION ROUTING                                              â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ Route to configured channels:                                  â”‚â”‚
â”‚     â”‚ â€¢ Immediate: PagerDuty, OpsGenie                               â”‚â”‚
â”‚     â”‚ â€¢ Important: Slack, Email                                      â”‚â”‚
â”‚     â”‚ â€¢ Info: Email only                                             â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â–¼                                        â”‚
â”‚  5. ALERT RESOLUTION                                                  â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ When metric returns to normal:                                 â”‚â”‚
â”‚     â”‚ â€¢ Alert state: ALERT â†’ OK                                      â”‚â”‚
â”‚     â”‚ â€¢ Send resolution notification                                 â”‚â”‚
â”‚     â”‚ â€¢ Log to alert history                                         â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Types d'Alertes Atlas

```yaml
# Alert Types Disponibles dans Atlas
alert_types:
  # Infrastructure
  - type: "HOST_CPU_USAGE"
    description: "CPU utilization on host"
    recommended_threshold: 80
    severity: WARNING

  - type: "HOST_MEMORY_USAGE"
    description: "Memory utilization"
    recommended_threshold: 85
    severity: CRITICAL

  - type: "HOST_DISK_USAGE"
    description: "Disk space utilization"
    recommended_threshold: 80
    severity: WARNING

  # Database Operations
  - type: "CONNECTIONS"
    description: "Number of connections"
    recommended_threshold: "80% of max"
    severity: WARNING

  - type: "REPLICATION_LAG"
    description: "Replication lag in seconds"
    recommended_threshold: 10
    severity: CRITICAL

  - type: "OPLOG_WINDOW"
    description: "Oplog window duration"
    recommended_threshold: 3600  # 1 hour
    severity: WARNING

  # Performance
  - type: "QUERY_TARGETING"
    description: "Inefficient queries (high scan ratio)"
    recommended_threshold: 10
    severity: INFO

  # Availability
  - type: "PRIMARY_ELECTED"
    description: "New primary elected"
    severity: WARNING

  - type: "REPLICA_SET_HAS_NO_PRIMARY"
    description: "No primary in replica set"
    severity: CRITICAL

  # Backups
  - type: "BACKUP_FAILED"
    description: "Backup failed"
    severity: CRITICAL
```

### Configuration d'Alertes

```hcl
# Terraform: Alert Configuration
resource "mongodbatlas_alert_configuration" "cpu_high" {
  project_id = var.atlas_project_id

  event_type = "HOST_CPU_USAGE"
  enabled    = true

  # Condition
  threshold {
    operator  = "GREATER_THAN"
    threshold = 80
    units     = "RAW"  # Percentage
  }

  # For how long before triggering
  metric_threshold {
    metric_name = "NORMALIZED_CPU_USER"
    operator    = "GREATER_THAN"
    threshold   = 80
    units       = "RAW"
    mode        = "AVERAGE"
  }

  # Notification channels
  notification {
    type_name     = "PAGER_DUTY"
    service_key   = var.pagerduty_key
    delay_min     = 0  # Immediate
  }

  notification {
    type_name     = "SLACK"
    channel_name  = "#alerts-production"
    api_token     = var.slack_token
    delay_min     = 0
  }

  notification {
    type_name         = "EMAIL"
    email_address     = "ops-team@company.com"
    delay_min         = 5  # Only if not resolved in 5 min
  }
}

# Memory Alert
resource "mongodbatlas_alert_configuration" "memory_critical" {
  project_id = var.atlas_project_id

  event_type = "HOST_MEMORY_USAGE"
  enabled    = true

  threshold {
    operator  = "GREATER_THAN"
    threshold = 90
    units     = "RAW"
  }

  notification {
    type_name   = "PAGER_DUTY"
    service_key = var.pagerduty_key
    delay_min   = 0
  }
}

# Replication Lag Alert
resource "mongodbatlas_alert_configuration" "replication_lag" {
  project_id = var.atlas_project_id

  event_type = "REPLICATION_LAG"
  enabled    = true

  threshold {
    operator  = "GREATER_THAN"
    threshold = 10
    units     = "SECONDS"
  }

  notification {
    type_name     = "SLACK"
    channel_name  = "#alerts-database"
    api_token     = var.slack_token
    delay_min     = 0
  }
}

# No Primary Alert (Critical)
resource "mongodbatlas_alert_configuration" "no_primary" {
  project_id = var.atlas_project_id

  event_type = "REPLICA_SET_HAS_NO_PRIMARY"
  enabled    = true

  notification {
    type_name   = "PAGER_DUTY"
    service_key = var.pagerduty_critical_key
    delay_min   = 0
  }

  notification {
    type_name = "WEBHOOK"
    url       = "https://monitoring.company.com/webhooks/mongodb-critical"
    secret    = var.webhook_secret
    delay_min = 0
  }
}
```

### StratÃ©gie d'Alerting par CriticitÃ©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ALERT SEVERITY MATRIX                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  SEVERITY    CONDITION             RESPONSE TIME    NOTIFICATION       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  ğŸ”¥ P0       â€¢ No primary           Immediate       â€¢ PagerDuty        â”‚
â”‚  CRITICAL    â€¢ Cluster down         (24/7)          â€¢ Phone call       â”‚
â”‚              â€¢ Backup failed                        â€¢ Slack (#critical)â”‚
â”‚              â€¢ Memory > 95%                         â€¢ Email (urgent)   â”‚
â”‚              Action: Wake up on-call engineer                          â”‚
â”‚                                                                        â”‚
â”‚  âš ï¸ P1       â€¢ CPU > 85%            < 15 minutes    â€¢ PagerDuty        â”‚
â”‚  HIGH        â€¢ Memory > 85%         (business hrs)  â€¢ Slack (#alerts)  â”‚
â”‚              â€¢ Replication lag >10s                 â€¢ Email            â”‚
â”‚              â€¢ Disk > 85%                                              â”‚
â”‚              Action: On-call acknowledges, investigates                â”‚
â”‚                                                                        â”‚
â”‚  âš ï¸ P2       â€¢ CPU > 70%            < 1 hour        â€¢ Slack (#alerts)  â”‚
â”‚  WARNING     â€¢ Memory > 75%                         â€¢ Email            â”‚
â”‚              â€¢ Connections > 70%                                       â”‚
â”‚              â€¢ Disk > 75%                                              â”‚
â”‚              Action: Team reviews during business hours                â”‚
â”‚                                                                        â”‚
â”‚  â„¹ï¸ P3       â€¢ Inefficient queries  < 24 hours      â€¢ Email (digest)   â”‚
â”‚  INFO        â€¢ Index suggestions                    â€¢ Slack (optional) â”‚
â”‚              â€¢ Oplog < 2 hours                                         â”‚
â”‚              Action: Review and optimize when convenient               â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”Œ IntÃ©grations Externes

### Datadog Integration

```yaml
# Datadog Integration Configuration
datadog_integration:
  # Atlas â†’ Datadog
  api_key: "YOUR_DATADOG_API_KEY"
  region: "US1"  # or EU1

  # Metrics exported to Datadog
  metrics:
    - "mongodb.atlas.cpu.user"
    - "mongodb.atlas.memory.used"
    - "mongodb.atlas.disk.used"
    - "mongodb.atlas.connections.current"
    - "mongodb.atlas.opcounters.query"
    - "mongodb.atlas.opcounters.insert"
    - "mongodb.atlas.opcounters.update"
    - "mongodb.atlas.replication.lag"

  # Tags for filtering
  tags:
    - "env:production"
    - "cluster:primary"
    - "team:backend"
```

```python
# Datadog Custom Metrics
from datadog import initialize, api
import requests

# Initialize Datadog
initialize(api_key='YOUR_DD_API_KEY', app_key='YOUR_DD_APP_KEY')

# Fetch Atlas metrics via API
atlas_api = "https://cloud.mongodb.com/api/atlas/v1.0"
response = requests.get(
    f"{atlas_api}/groups/{project_id}/processes/{host}/measurements",
    auth=(public_key, private_key),
    params={'granularity': 'PT1M', 'period': 'PT1H'}
)

metrics = response.json()

# Send to Datadog
for metric in metrics['measurements']:
    api.Metric.send(
        metric=f"mongodb.atlas.{metric['name']}",
        points=[(dp['timestamp'], dp['value']) for dp in metric['dataPoints']],
        tags=['cluster:production', 'env:prod']
    )
```

### Prometheus Integration

```yaml
# MongoDB Exporter for Prometheus
# Deploy mongodb_exporter as a sidecar or standalone service

# docker-compose.yml
services:
  mongodb-exporter:
    image: bitnami/mongodb-exporter:latest
    environment:
      - MONGODB_URI=mongodb+srv://monitor:password@cluster0.xxxxx.mongodb.net/?authSource=admin
      - MONGODB_DIRECT_CONNECT=false
      - MONGODB_GLOBAL_CONN_POOL=true
    ports:
      - "9216:9216"
    restart: unless-stopped

# Prometheus scrape config
# prometheus.yml
scrape_configs:
  - job_name: 'mongodb-atlas'
    static_configs:
      - targets: ['mongodb-exporter:9216']
        labels:
          cluster: 'production'
          env: 'prod'
```

### Grafana Dashboards

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   GRAFANA DASHBOARD FOR ATLAS                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  Panel 1: Operations per Second                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Query:    rate(mongodb_opcounters_query[5m])                     â”‚ â”‚
â”‚  â”‚ Insert:   rate(mongodb_opcounters_insert[5m])                    â”‚ â”‚
â”‚  â”‚ Update:   rate(mongodb_opcounters_update[5m])                    â”‚ â”‚
â”‚  â”‚ Delete:   rate(mongodb_opcounters_delete[5m])                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                       â”‚
â”‚  Panel 2: Resource Utilization                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ CPU:      mongodb_system_cpu_usage{type="user"}                  â”‚ â”‚
â”‚  â”‚ Memory:   mongodb_memory_resident / mongodb_memory_virtual * 100 â”‚ â”‚
â”‚  â”‚ Disk:     mongodb_disk_partition_usage                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                       â”‚
â”‚  Panel 3: Connections                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Current:    mongodb_connections{state="current"}                 â”‚ â”‚
â”‚  â”‚ Available:  mongodb_connections{state="available"}               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                       â”‚
â”‚  Panel 4: Replication Lag                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ mongodb_replication_lag_seconds                                  â”‚ â”‚
â”‚  â”‚ Alert: > 10s                                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Best Practices de Monitoring

### Checklist Production

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MONITORING BEST PRACTICES CHECKLIST                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  METRICS & DASHBOARDS                                                  â”‚
â”‚  â˜ Real-time dashboard configured and accessible                       â”‚
â”‚  â˜ Key metrics identified for your workload                            â”‚
â”‚  â˜ Baselines established for normal operation                          â”‚
â”‚  â˜ Custom dashboards created for specific use cases                    â”‚
â”‚  â˜ Dashboards shared with team (bookmarks, links)                      â”‚
â”‚                                                                        â”‚
â”‚  ALERTING                                                              â”‚
â”‚  â˜ Critical alerts configured (no primary, backup failed)              â”‚
â”‚  â˜ Warning alerts for resource thresholds (CPU, RAM, disk)             â”‚
â”‚  â˜ Replication lag alerts configured                                   â”‚
â”‚  â˜ Connection exhaustion alerts                                        â”‚
â”‚  â˜ Notification channels tested (PagerDuty, Slack, email)              â”‚
â”‚  â˜ Alert severity levels defined                                       â”‚
â”‚  â˜ On-call rotation established                                        â”‚
â”‚  â˜ Alert fatigue minimized (no noisy alerts)                           â”‚
â”‚                                                                        â”‚
â”‚  PERFORMANCE                                                           â”‚
â”‚  â˜ Performance Advisor reviewed weekly                                 â”‚
â”‚  â˜ Query Profiler enabled (threshold: 100ms)                           â”‚
â”‚  â˜ Slow queries reviewed and optimized                                 â”‚
â”‚  â˜ Index recommendations evaluated                                     â”‚
â”‚  â˜ Unused indexes identified and removed                               â”‚
â”‚                                                                        â”‚
â”‚  INTEGRATIONS                                                          â”‚
â”‚  â˜ Metrics exported to central monitoring (Datadog/Prometheus)         â”‚
â”‚  â˜ Logs aggregated (if needed)                                         â”‚
â”‚  â˜ Dashboards created in Grafana/Datadog                               â”‚
â”‚  â˜ Correlation with application metrics                                â”‚
â”‚                                                                        â”‚
â”‚  DOCUMENTATION                                                         â”‚
â”‚  â˜ Runbooks created for common alerts                                  â”‚
â”‚  â˜ Escalation procedures documented                                    â”‚
â”‚  â˜ Contact information up to date                                      â”‚
â”‚  â˜ Post-mortem template prepared                                       â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Les 4 Golden Signals (SRE)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    THE FOUR GOLDEN SIGNALS (SRE)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  1. LATENCY                                                           â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ What: Time to service a request                                â”‚â”‚
â”‚     â”‚ Metrics:                                                       â”‚â”‚
â”‚     â”‚ â€¢ Average query execution time                                 â”‚â”‚
â”‚     â”‚ â€¢ P50, P95, P99 query latency                                  â”‚â”‚
â”‚     â”‚ â€¢ Slow query count (> 100ms)                                   â”‚â”‚
â”‚     â”‚                                                                â”‚â”‚
â”‚     â”‚ Target: P99 < 100ms for OLTP queries                           â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                       â”‚
â”‚  2. TRAFFIC                                                           â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ What: Demand on the system                                     â”‚â”‚
â”‚     â”‚ Metrics:                                                       â”‚â”‚
â”‚     â”‚ â€¢ Operations per second (reads/writes)                         â”‚â”‚
â”‚     â”‚ â€¢ Connections current                                          â”‚â”‚
â”‚     â”‚ â€¢ Network throughput (bytes in/out)                            â”‚â”‚
â”‚     â”‚                                                                â”‚â”‚
â”‚     â”‚ Target: Establish baseline, alert on +/- 50% deviation         â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                       â”‚
â”‚  3. ERRORS                                                            â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ What: Rate of failed requests                                  â”‚â”‚
â”‚     â”‚ Metrics:                                                       â”‚â”‚
â”‚     â”‚ â€¢ Failed operations (auth failures, write errors)              â”‚â”‚
â”‚     â”‚ â€¢ Connection failures                                          â”‚â”‚
â”‚     â”‚ â€¢ Replication errors                                           â”‚â”‚
â”‚     â”‚                                                                â”‚â”‚
â”‚     â”‚ Target: Error rate < 0.1%                                      â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                       â”‚
â”‚  4. SATURATION                                                        â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚     â”‚ What: How "full" the system is                                 â”‚â”‚
â”‚     â”‚ Metrics:                                                       â”‚â”‚
â”‚     â”‚ â€¢ CPU utilization                                              â”‚â”‚
â”‚     â”‚ â€¢ Memory utilization                                           â”‚â”‚
â”‚     â”‚ â€¢ Disk IOPS usage                                              â”‚â”‚
â”‚     â”‚ â€¢ Connection pool utilization                                  â”‚â”‚
â”‚     â”‚                                                                â”‚â”‚
â”‚     â”‚ Target: < 80% utilization to handle bursts                     â”‚â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Anti-Patterns Ã  Ã‰viter

```
âŒ ANTI-PATTERNS:

1. Alert Fatigue
   â€¢ Too many low-priority alerts
   â€¢ Non-actionable alerts
   â€¢ Alerts with no clear resolution path
   â†’ Solution: Be selective, use appropriate severity

2. Monitoring Everything
   â€¢ Tracking 100+ metrics without purpose
   â€¢ Dashboards with 50+ panels
   â†’ Solution: Focus on Golden Signals + business metrics

3. No Baselines
   â€¢ Alerts with arbitrary thresholds
   â€¢ No understanding of normal behavior
   â†’ Solution: Establish baselines over 2-4 weeks

4. Ignoring Trends
   â€¢ Only reacting to immediate issues
   â€¢ Not noticing gradual degradation
   â†’ Solution: Track trends, set trend-based alerts

5. No Runbooks
   â€¢ Alerts without context or remediation steps
   â€¢ Engineers guessing what to do
   â†’ Solution: Document common scenarios

6. Single Point of View
   â€¢ Only monitoring infrastructure, not application
   â€¢ Not correlating database with app metrics
   â†’ Solution: Unified observability strategy
```

---

## ğŸ RÃ©sumÃ©

### Points ClÃ©s

1. **MÃ©triques Essentielles**
   - Resource: CPU, Memory, Disk, Network
   - Database: Operations, Connections, Replication Lag
   - Performance: Query latency, Index usage
   - Availability: Replica Set health

2. **Dashboards**
   - Real-time Performance (10s updates)
   - Hardware Metrics (1min updates)
   - Query Performance
   - Replica Set Status

3. **Performance Advisor**
   - Analyse automatique ML
   - Recommandations d'index
   - Identification index inutilisÃ©s
   - Impact estimÃ©

4. **Query Profiler**
   - Level 1 (slow queries) pour production
   - Threshold: 100ms par dÃ©faut
   - Analyse execution plans
   - Identification COLLSCAN

5. **Alerting Strategy**
   - P0 Critical: PagerDuty, immediate
   - P1 High: Slack, < 15min
   - P2 Warning: Email, < 1 hour
   - P3 Info: Digest, < 24 hours

6. **IntÃ©grations**
   - Datadog: MÃ©triques centralisÃ©es
   - Prometheus: Time-series + Grafana
   - PagerDuty: On-call management
   - Slack: Team communication

### Configuration Minimale Production

```hcl
# Essential Alerts for Production
alerts = [
  {
    type      = "REPLICA_SET_HAS_NO_PRIMARY"
    severity  = "CRITICAL"
    channel   = "pagerduty"
  },
  {
    type      = "HOST_CPU_USAGE"
    threshold = 85
    severity  = "WARNING"
    channel   = "slack"
  },
  {
    type      = "HOST_MEMORY_USAGE"
    threshold = 90
    severity  = "CRITICAL"
    channel   = "pagerduty"
  },
  {
    type      = "REPLICATION_LAG"
    threshold = 10  # seconds
    severity  = "WARNING"
    channel   = "slack"
  },
  {
    type      = "BACKUP_FAILED"
    severity  = "CRITICAL"
    channel   = "pagerduty"
  }
]
```

### Ressources

- [Atlas Monitoring Documentation](https://www.mongodb.com/docs/atlas/monitoring-alerts/)
- [Performance Advisor](https://www.mongodb.com/docs/atlas/performance-advisor/)
- [Query Profiler](https://www.mongodb.com/docs/manual/tutorial/manage-the-database-profiler/)
- [Alert Configuration](https://www.mongodb.com/docs/atlas/configure-alerts/)

---


â­ï¸ [Backups et restauration](/14-mongodb-atlas/07-backups-restauration.md)
