üîù Retour au [Sommaire](/SOMMAIRE.md)

# 6.4.10 $sample

## Introduction

L'√©tape `$sample` est un op√©rateur du framework d'agr√©gation MongoDB qui permet de s√©lectionner **al√©atoirement** un nombre sp√©cifi√© de documents dans une collection. C'est l'√©quivalent de tirer des documents au hasard parmi tous ceux disponibles.

### L'Essentiel

- **√âchantillonnage al√©atoire** : S√©lectionne N documents au hasard
- **Syntaxe simple** : Un seul param√®tre (le nombre de documents)
- **Position flexible** : Peut √™tre utilis√© n'importe o√π dans le pipeline
- **Non-d√©terministe** : Chaque ex√©cution peut donner des r√©sultats diff√©rents

### Analogie Simple

Imaginez une **bo√Æte remplie de billets de loterie num√©rot√©s** :
- Vous voulez en tirer **5 au hasard**
- Vous m√©langez bien la bo√Æte
- Vous en sortez 5 sans regarder
- Les 5 billets tir√©s sont votre **√©chantillon al√©atoire**

`$sample` fait exactement cela avec vos documents MongoDB : il en s√©lectionne un nombre d√©fini **de mani√®re al√©atoire**.

---

## Pourquoi Utiliser $sample ?

`$sample` est essentiel pour :

1. **Tests et d√©veloppement** : Obtenir rapidement des donn√©es de test
2. **Pr√©visualisations** : Afficher quelques exemples sans tout charger
3. **Analyses statistiques** : √âchantillons repr√©sentatifs de grandes collections
4. **D√©mos et prototypes** : Donn√©es r√©alistes sans exposer toute la base
5. **A/B Testing** : S√©lectionner des groupes al√©atoires d'utilisateurs
6. **Audits al√©atoires** : V√©rifier la qualit√© sur un √©chantillon
7. **Machine Learning** : Cr√©er des ensembles d'entra√Ænement/test

---

## Syntaxe

```javascript
{
  $sample: {
    size: <nombre_de_documents>
  }
}
```

### Param√®tre

| Param√®tre | Description | Type | Obligatoire |
|-----------|-------------|------|-------------|
| `size` | Nombre de documents √† retourner | Entier positif | ‚úÖ Oui |

---

## Exemple Simple

### Donn√©es de D√©part

```javascript
db.produits.insertMany([
  { _id: 1, nom: "Laptop", prix: 899, categorie: "Informatique" },
  { _id: 2, nom: "Souris", prix: 29, categorie: "Informatique" },
  { _id: 3, nom: "Clavier", prix: 79, categorie: "Informatique" },
  { _id: 4, nom: "Bureau", prix: 299, categorie: "Mobilier" },
  { _id: 5, nom: "Chaise", prix: 159, categorie: "Mobilier" },
  { _id: 6, nom: "√âcran", prix: 349, categorie: "Informatique" },
  { _id: 7, nom: "Lampe", prix: 45, categorie: "Mobilier" },
  { _id: 8, nom: "Webcam", prix: 89, categorie: "Informatique" },
  { _id: 9, nom: "Casque", prix: 129, categorie: "Informatique" },
  { _id: 10, nom: "Tapis", prix: 25, categorie: "Mobilier" }
])
```

### Application de $sample

S√©lectionnons **3 produits al√©atoires** :

```javascript
db.produits.aggregate([
  {
    $sample: { size: 3 }
  }
])
```

### R√©sultat Possible (Exemple 1)

```json
[
  { "_id": 7, "nom": "Lampe", "prix": 45, "categorie": "Mobilier" },
  { "_id": 2, "nom": "Souris", "prix": 29, "categorie": "Informatique" },
  { "_id": 9, "nom": "Casque", "prix": 129, "categorie": "Informatique" }
]
```

### R√©sultat Possible (Exemple 2 - Autre Ex√©cution)

```json
[
  { "_id": 4, "nom": "Bureau", "prix": 299, "categorie": "Mobilier" },
  { "_id": 1, "nom": "Laptop", "prix": 899, "categorie": "Informatique" },
  { "_id": 10, "nom": "Tapis", "prix": 25, "categorie": "Mobilier" }
]
```

### Observations

- Les r√©sultats sont **diff√©rents** √† chaque ex√©cution
- Exactement **3 documents** sont retourn√©s
- L'ordre est **al√©atoire**
- Les documents sont s√©lectionn√©s **sans duplication**

---

## Comportement D√©taill√©

### Si size >= Nombre Total de Documents

Si vous demandez plus de documents qu'il n'y en a dans la collection :

```javascript
// Collection avec 10 documents
db.produits.aggregate([
  {
    $sample: { size: 100 }  // Demande 100 documents
  }
])
```

**R√©sultat** : Tous les 10 documents sont retourn√©s (dans un ordre al√©atoire), pas de duplication.

### Si size = 0

```javascript
db.produits.aggregate([
  {
    $sample: { size: 0 }
  }
])
```

**R√©sultat** : Aucun document n'est retourn√© (tableau vide).

### Avec des Collections Vides

```javascript
db.collection_vide.aggregate([
  {
    $sample: { size: 5 }
  }
])
```

**R√©sultat** : Aucun document (tableau vide).

---

## M√©thodes d'√âchantillonnage

MongoDB utilise **deux m√©thodes diff√©rentes** pour √©chantillonner, selon les conditions :

### M√©thode 1 : Pseudo-Random Cursor (Rapide)

**Conditions** :
- `size` ‚â§ 5% de la collection
- OU `size` ‚â§ 100 documents
- Collection **non shard√©e**

**Comment √ßa marche** :
- Utilise un curseur al√©atoire optimis√©
- Tr√®s **rapide** car ne scanne pas tous les documents
- Peut sauter des documents de mani√®re efficace

### M√©thode 2 : Random Sort (Plus Lent)

**Conditions** :
- `size` > 5% de la collection
- ET `size` > 100 documents
- OU collection **shard√©e**

**Comment √ßa marche** :
- Ajoute un champ al√©atoire √† chaque document
- Trie tous les documents par ce champ al√©atoire
- Prend les N premiers
- Plus **lent** car n√©cessite de traiter tous les documents

### Implications Pratiques

```javascript
// ‚úÖ Rapide : M√©thode 1 (pseudo-random cursor)
db.grande_collection.aggregate([
  { $sample: { size: 50 } }  // < 100 documents
])

// ‚ö†Ô∏è Plus lent : M√©thode 2 (random sort)
db.grande_collection.aggregate([
  { $sample: { size: 5000 } }  // > 100 documents ET > 5%
])
```

---

## Position dans le Pipeline

### Au D√©but du Pipeline

Filtrer d'abord avec un √©chantillon al√©atoire :

```javascript
db.produits.aggregate([
  // Prendre 5 produits al√©atoires
  {
    $sample: { size: 5 }
  },
  // Puis les trier par prix
  {
    $sort: { prix: -1 }
  }
])
```

### Au Milieu du Pipeline

√âchantillonner apr√®s un filtrage :

```javascript
db.produits.aggregate([
  // Filtrer d'abord
  {
    $match: { categorie: "Informatique" }
  },
  // Prendre 3 produits al√©atoires parmi ceux filtr√©s
  {
    $sample: { size: 3 }
  }
])
```

### √Ä la Fin du Pipeline

√âchantillonner les r√©sultats d'une agr√©gation :

```javascript
db.ventes.aggregate([
  {
    $group: {
      _id: "$produit",
      total_ventes: { $sum: "$montant" }
    }
  },
  // Prendre 5 produits al√©atoires parmi les r√©sultats agr√©g√©s
  {
    $sample: { size: 5 }
  }
])
```

---

## Cas d'Usage Courants

### 1. Pr√©visualisation de Donn√©es

Afficher quelques exemples pour l'utilisateur :

```javascript
// Page d'accueil : Afficher 6 produits al√©atoires
db.produits.aggregate([
  {
    $match: {
      disponible: true,
      stock: { $gt: 0 }
    }
  },
  {
    $sample: { size: 6 }
  },
  {
    $project: {
      nom: 1,
      prix: 1,
      image: 1
    }
  }
])
```

### 2. Tests et D√©veloppement

Obtenir des donn√©es de test r√©alistes :

```javascript
// D√©veloppeur : Besoin de 10 commandes pour tester
db.commandes.aggregate([
  {
    $sample: { size: 10 }
  }
])
```

### 3. Analyse Statistique

√âchantillon repr√©sentatif d'une grande collection :

```javascript
// Analyser 1000 documents sur une collection de 10 millions
db.logs.aggregate([
  {
    $sample: { size: 1000 }
  },
  {
    $group: {
      _id: "$status_code",
      nombre: { $sum: 1 },
      temps_moyen: { $avg: "$response_time" }
    }
  }
])
```

### 4. A/B Testing

S√©lectionner des groupes al√©atoires :

```javascript
// Groupe A : 100 utilisateurs al√©atoires pour la fonctionnalit√© beta
db.utilisateurs.aggregate([
  {
    $match: { actif: true }
  },
  {
    $sample: { size: 100 }
  },
  {
    $merge: {
      into: "groupe_test_beta",
      whenMatched: "replace",
      whenNotMatched: "insert"
    }
  }
])
```

### 5. Audit de Qualit√©

V√©rifier al√©atoirement la qualit√© des donn√©es :

```javascript
// Auditer 50 produits al√©atoires
db.produits.aggregate([
  {
    $sample: { size: 50 }
  },
  {
    $project: {
      nom: 1,
      prix: 1,
      description: 1,
      // V√©rifications
      description_complete: {
        $gte: [{ $strLenCP: "$description" }, 50]
      },
      prix_valide: {
        $and: [
          { $gt: ["$prix", 0] },
          { $lt: ["$prix", 100000] }
        ]
      }
    }
  }
])
```

### 6. Recommandations "D√©couvrez aussi"

Sugg√©rer des produits al√©atoires :

```javascript
// Produits similaires al√©atoires
db.produits.aggregate([
  {
    $match: {
      categorie: "Informatique",
      _id: { $ne: 123 }  // Pas le produit actuel
    }
  },
  {
    $sample: { size: 4 }
  },
  {
    $project: {
      nom: 1,
      prix: 1,
      image: 1,
      note: 1
    }
  }
])
```

---

## Combinaison avec d'Autres √âtapes

### Exemple 1 : √âchantillon Filtr√© et Enrichi

```javascript
db.articles.aggregate([
  // 1. Filtrer les articles publi√©s
  {
    $match: {
      statut: "publi√©",
      date: { $gte: ISODate("2024-01-01") }
    }
  },

  // 2. Prendre 5 articles al√©atoires
  {
    $sample: { size: 5 }
  },

  // 3. Enrichir avec les infos auteur
  {
    $lookup: {
      from: "auteurs",
      localField: "auteur_id",
      foreignField: "_id",
      as: "auteur"
    }
  },

  // 4. Projeter les champs n√©cessaires
  {
    $project: {
      titre: 1,
      resume: 1,
      "auteur.nom": 1,
      date: 1
    }
  }
])
```

### Exemple 2 : √âchantillons par Cat√©gorie

```javascript
db.produits.aggregate([
  // Grouper par cat√©gorie et prendre un √©chantillon de chaque
  {
    $group: {
      _id: "$categorie",
      produits: { $push: "$$ROOT" }
    }
  },
  {
    $project: {
      categorie: "$_id",
      // Prendre 3 produits al√©atoires par cat√©gorie
      echantillon: { $slice: ["$produits", 3] }
    }
  }
])
```

**Note** : `$slice` n'est pas al√©atoire. Pour un vrai √©chantillon al√©atoire par groupe, il faut une approche diff√©rente :

```javascript
db.produits.aggregate([
  {
    $facet: {
      "informatique": [
        { $match: { categorie: "Informatique" } },
        { $sample: { size: 3 } }
      ],
      "mobilier": [
        { $match: { categorie: "Mobilier" } },
        { $sample: { size: 3 } }
      ]
    }
  }
])
```

---

## Comparaison avec limit()

### $sample vs $limit

| Aspect | $sample | $limit |
|--------|---------|--------|
| **Ordre** | ‚ùå Al√©atoire | ‚úÖ Ordre naturel ou tri√© |
| **R√©sultats** | ‚ö†Ô∏è Diff√©rents √† chaque fois | ‚úÖ Toujours les m√™mes |
| **Performance** | ‚ö†Ô∏è Peut √™tre lent (grande size) | ‚úÖ Rapide |
| **Usage** | √âchantillons, tests, vari√©t√© | Pagination, top N |

### Exemples Comparatifs

```javascript
// $limit : Toujours les 5 premiers (ordre d'insertion)
db.produits.aggregate([
  { $limit: 5 }
])
// R√©sultat : Toujours les m√™mes 5 produits

// $sample : 5 produits al√©atoires
db.produits.aggregate([
  { $sample: { size: 5 } }
])
// R√©sultat : Diff√©rent √† chaque ex√©cution
```

### Quand Utiliser Chacun

**Utilisez `$sample`** pour :
- ‚úÖ √âchantillons **al√©atoires**
- ‚úÖ **Tests** avec donn√©es vari√©es
- ‚úÖ **D√©couverte** de contenu
- ‚úÖ **Pr√©visualisations** vari√©es

**Utilisez `$limit`** pour :
- ‚úÖ **Pagination** (avec $skip)
- ‚úÖ **Top N** (avec $sort)
- ‚úÖ R√©sultats **d√©terministes**
- ‚úÖ **Performance** optimale

---

## Performances

### Facteurs Impactant les Performances

1. **Taille de l'√©chantillon (size)** :
   - Petit √©chantillon (< 100) : ‚úÖ Rapide
   - Grand √©chantillon (> 5% de la collection) : ‚ö†Ô∏è Plus lent

2. **Taille de la collection** :
   - Petite collection : ‚úÖ Rapide
   - Grande collection avec petit √©chantillon : ‚úÖ Rapide
   - Grande collection avec grand √©chantillon : ‚ö†Ô∏è Lent

3. **Position dans le pipeline** :
   - Au d√©but (peu de documents) : ‚úÖ Rapide
   - Apr√®s filtrage (documents r√©duits) : ‚úÖ Rapide

### Optimisations

#### 1. Filtrer Avant d'√âchantillonner

```javascript
// ‚úÖ Bon : R√©duire d'abord le volume
db.produits.aggregate([
  {
    $match: {
      categorie: "Informatique",
      prix: { $lt: 500 }
    }
  },
  {
    $sample: { size: 10 }
  }
])

// ‚ùå Moins efficace
db.produits.aggregate([
  {
    $sample: { size: 1000 }  // √âchantillon large
  },
  {
    $match: { categorie: "Informatique" }  // Puis filtrer
  }
])
```

#### 2. Limiter la Taille de l'√âchantillon

```javascript
// ‚úÖ Bon : Petits √©chantillons
db.grande_collection.aggregate([
  { $sample: { size: 50 } }  // Rapide avec m√©thode 1
])

// ‚ö†Ô∏è Attention : Grands √©chantillons
db.grande_collection.aggregate([
  { $sample: { size: 50000 } }  // Lent avec m√©thode 2
])
```

#### 3. Projeter T√¥t

```javascript
// ‚úÖ Bon : R√©duire la taille des documents
db.produits.aggregate([
  {
    $project: {
      nom: 1,
      prix: 1,
      categorie: 1
    }
  },
  {
    $sample: { size: 100 }
  }
])
```

---

## Limitations et Consid√©rations

### 1. Non-D√©terministe

```javascript
// Ex√©cution 1
db.produits.aggregate([{ $sample: { size: 3 } }])
// ‚Üí [doc1, doc5, doc9]

// Ex√©cution 2 (imm√©diate)
db.produits.aggregate([{ $sample: { size: 3 } }])
// ‚Üí [doc3, doc7, doc2]  // Diff√©rent !
```

**Implication** : Ne pas utiliser pour des r√©sultats qui doivent √™tre **reproductibles**.

### 2. Pas de Contr√¥le sur la Distribution

Vous ne pouvez pas :
- Garantir une distribution uniforme par cat√©gorie
- Forcer certains documents √† √™tre inclus
- Exclure certains documents sp√©cifiques (utilisez $match avant)

### 3. Performance sur Collections Shard√©es

Sur des collections **shard√©es**, `$sample` utilise toujours la **m√©thode 2** (random sort), qui est plus lente.

### 4. Pas de Duplication

`$sample` ne retourne jamais le m√™me document deux fois dans un seul √©chantillon.

```javascript
// M√™me si size > nombre de documents
db.collection_10_docs.aggregate([
  { $sample: { size: 100 } }
])
// R√©sultat : Maximum 10 documents (tous diff√©rents)
```

---

## Bonnes Pratiques

### 1. Utiliser $match Avant $sample

```javascript
// ‚úÖ Bon : Filtrer puis √©chantillonner
db.produits.aggregate([
  {
    $match: {
      disponible: true,
      stock: { $gt: 0 }
    }
  },
  {
    $sample: { size: 10 }
  }
])
```

### 2. Garder size Raisonnable

```javascript
// ‚úÖ Bon : Petits √©chantillons
{ $sample: { size: 100 } }

// ‚ö†Ô∏è √âviter : Tr√®s grands √©chantillons
{ $sample: { size: 100000 } }  // Utiliser une autre approche
```

### 3. Documenter l'Usage

```javascript
/**
 * S√©lectionne 5 articles al√©atoires pour la page d'accueil
 * Note : Les r√©sultats changent √† chaque requ√™te
 */
db.articles.aggregate([
  { $match: { featured: true } },
  { $sample: { size: 5 } }
])
```

### 4. Tester avec Diff√©rentes Ex√©cutions

```javascript
// Ex√©cuter plusieurs fois pour v√©rifier la vari√©t√©
for (let i = 0; i < 5; i++) {
  console.log(`√âchantillon ${i + 1}:`)
  db.produits.aggregate([
    { $sample: { size: 3 } }
  ]).forEach(doc => console.log(doc.nom))
  console.log("---")
}
```

### 5. Combiner avec $facet pour Plusieurs √âchantillons

```javascript
// Plusieurs √©chantillons ind√©pendants
db.produits.aggregate([
  {
    $facet: {
      "echantillon_1": [{ $sample: { size: 5 } }],
      "echantillon_2": [{ $sample: { size: 5 } }],
      "echantillon_3": [{ $sample: { size: 5 } }]
    }
  }
])
```

---

## Exemple Complet : Site E-commerce

```javascript
// Collection de produits
db.produits.insertMany([
  { _id: 1, nom: "Laptop Pro", categorie: "Informatique", prix: 1299, note: 4.5, ventes: 150 },
  { _id: 2, nom: "Souris Gaming", categorie: "Informatique", prix: 59, note: 4.2, ventes: 320 },
  { _id: 3, nom: "Clavier M√©canique", categorie: "Informatique", prix: 129, note: 4.7, ventes: 210 },
  { _id: 4, nom: "Bureau Ergonomique", categorie: "Mobilier", prix: 399, note: 4.3, ventes: 85 },
  { _id: 5, nom: "Chaise Gaming", categorie: "Mobilier", prix: 299, note: 4.6, ventes: 120 },
  { _id: 6, nom: "√âcran 4K", categorie: "Informatique", prix: 449, note: 4.8, ventes: 95 },
  { _id: 7, nom: "Lampe LED", categorie: "Mobilier", prix: 49, note: 4.1, ventes: 280 },
  { _id: 8, nom: "Webcam HD", categorie: "Informatique", prix: 89, note: 4.4, ventes: 175 },
  { _id: 9, nom: "Casque Audio", categorie: "Informatique", prix: 149, note: 4.5, ventes: 200 },
  { _id: 10, nom: "Tapis de Souris", categorie: "Informatique", prix: 19, note: 4.0, ventes: 450 }
])

// Cas 1 : Page d'accueil - Suggestions al√©atoires
db.produits.aggregate([
  {
    $match: {
      note: { $gte: 4.0 }  // Seulement les bien not√©s
    }
  },
  {
    $sample: { size: 4 }  // 4 produits al√©atoires
  },
  {
    $project: {
      nom: 1,
      prix: 1,
      note: 1,
      economie: {
        $cond: {
          if: { $gte: ["$prix", 100] },
          then: { $multiply: ["$prix", 0.10] },  // 10% de r√©duction
          else: 0
        }
      }
    }
  },
  {
    $addFields: {
      prix_promo: {
        $subtract: ["$prix", "$economie"]
      }
    }
  }
])

// Cas 2 : Section "D√©couvrez aussi" (produits similaires)
const produitActuel = 1  // Laptop Pro

db.produits.aggregate([
  {
    $match: {
      _id: { $ne: produitActuel },  // Pas le produit actuel
      categorie: "Informatique"     // M√™me cat√©gorie
    }
  },
  {
    $sample: { size: 3 }
  },
  {
    $project: {
      nom: 1,
      prix: 1,
      note: 1
    }
  }
])

// Cas 3 : Programme de test utilisateurs
db.utilisateurs.aggregate([
  {
    $match: {
      actif: true,
      derniere_connexion: {
        $gte: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000)  // Actif dans les 30 derniers jours
      }
    }
  },
  {
    $sample: { size: 100 }  // 100 testeurs al√©atoires
  },
  {
    $project: {
      _id: 1,
      email: 1,
      nom: 1
    }
  },
  {
    $merge: {
      into: "beta_testers",
      whenMatched: "replace",
      whenNotMatched: "insert"
    }
  }
])

// Cas 4 : Analyse de performance (√©chantillon statistique)
db.logs_api.aggregate([
  {
    $match: {
      date: {
        $gte: ISODate("2024-03-01"),
        $lt: ISODate("2024-04-01")
      }
    }
  },
  {
    $sample: { size: 10000 }  // √âchantillon de 10k requ√™tes
  },
  {
    $group: {
      _id: "$endpoint",
      temps_moyen: { $avg: "$temps_reponse_ms" },
      temps_max: { $max: "$temps_reponse_ms" },
      nombre_echantillon: { $sum: 1 }
    }
  },
  {
    $sort: { temps_moyen: -1 }
  }
])

// Cas 5 : Rotation de banni√®res publicitaires
db.publicites.aggregate([
  {
    $match: {
      active: true,
      date_debut: { $lte: new Date() },
      date_fin: { $gte: new Date() }
    }
  },
  {
    $sample: { size: 1 }  // Une seule pub al√©atoire
  },
  {
    $project: {
      titre: 1,
      image_url: 1,
      lien: 1
    }
  }
])
```

---

## R√©sum√©

### Points Cl√©s

| Aspect | Description |
|--------|-------------|
| **Fonction** | S√©lectionne N documents al√©atoires |
| **Syntaxe** | `{ $sample: { size: N } }` |
| **R√©sultats** | Diff√©rents √† chaque ex√©cution |
| **Duplication** | Aucune (chaque document unique) |
| **Performance** | Rapide si size < 100 ou < 5% |
| **Position** | Flexible dans le pipeline |

### Deux M√©thodes d'√âchantillonnage

| M√©thode | Conditions | Performance |
|---------|------------|-------------|
| **Pseudo-Random Cursor** | size ‚â§ 100 OU ‚â§ 5% | ‚úÖ Rapide |
| **Random Sort** | size > 100 ET > 5% | ‚ö†Ô∏è Plus lent |

### Quand Utiliser $sample

‚úÖ **Utilisez $sample** pour :
- **Pr√©visualisations** al√©atoires
- **Tests** et d√©veloppement
- **D√©couverte** de contenu
- **Analyses statistiques** (√©chantillons)
- **A/B Testing** (groupes al√©atoires)
- **Recommandations** vari√©es
- **Audits** al√©atoires

‚ùå **N'utilisez PAS $sample** pour :
- R√©sultats **reproductibles** ‚Üí Utilisez $sort + $limit
- **Pagination** ‚Üí Utilisez $skip + $limit
- **Top N** ‚Üí Utilisez $sort + $limit
- Tr√®s grands √©chantillons (> 10% collection) ‚Üí Autre approche

---

## Conclusion

`$sample` est un outil **simple mais puissant** pour obtenir des √©chantillons al√©atoires de documents. Il est particuli√®rement utile pour les tests, les pr√©visualisations, et les analyses statistiques sur de grandes collections.

### √Ä Retenir

1. **$sample** s√©lectionne des documents **al√©atoirement**
2. Syntaxe simple : **un seul param√®tre** (size)
3. R√©sultats **diff√©rents** √† chaque ex√©cution
4. **Pas de duplication** dans un √©chantillon
5. **Rapide** pour petits √©chantillons (< 100)
6. **Peut √™tre lent** pour grands √©chantillons (> 5% de la collection)
7. **Filtrez avant** d'√©chantillonner pour de meilleures performances
8. Utilisable **n'importe o√π** dans le pipeline

### Prochaines √âtapes

Dans les sections suivantes, nous explorerons :
- **$unionWith** : Combiner les r√©sultats de plusieurs collections
- **Optimisation des pipelines** : Techniques avanc√©es de performance
- **Patterns d'agr√©gation** : Cas d'usage avanc√©s

---

**üìö R√©f√©rences**

- [Documentation officielle $sample](https://www.mongodb.com/docs/manual/reference/operator/aggregation/sample/)
- [Aggregation Pipeline](https://www.mongodb.com/docs/manual/core/aggregation-pipeline/)
- [Aggregation Pipeline Optimization](https://www.mongodb.com/docs/manual/core/aggregation-pipeline-optimization/)
- [Random Sampling in Databases](https://en.wikipedia.org/wiki/Reservoir_sampling)

‚è≠Ô∏è [$unionWith](/06-framework-agregation/04.11-unionwith.md)
